//---------------------------------------------------------------------------


#pragma hdrstop
#include <vcl.h>
#include "logs.h"
#include <stdio.h>

int h;
FILE * fp=NULL;
/////////////////////////////////////////////////////////////////////////////////
void inilog(AnsiString s){// инициация log-файла с именем s
/////////////////////////////////////////////////////////////////////////////////
//  h=FileCreate(s);
fp=(FILE*)fopen(s.c_str(), "w+");
//  FileClose(h);
//  FileOpen(s,fmOpenReadWrite|fmShareDenyNone);

}
char nl[]="\n\r\n\r";
/////////////////////////////////////////////////////////////////////////////////
void addstr(AnsiString s){ //добавить стоку s в лог-файл
/////////////////////////////////////////////////////////////////////////////////
//  fwrite   fputc
  //FileWrite(h,s.c_str(),s.Length());
  //FileWrite(h,nl,1);
  if(fp==NULL)return;
  fwrite(s.c_str(),s.Length(),1,fp);
  fwrite(nl,1,1,fp);
  fflush(fp);

}
/////////////////////////////////////////////////////////////////////////////////
void closelog(){// закрытие лог- файла
/////////////////////////////////////////////////////////////////////////////////
fclose(fp);
}
int hcsv=0;
//---------------------------------------------------------------------------
/////////////////////////////////////////////////////////////////////////////////
int inicsv(){// инициация файла csv
/////////////////////////////////////////////////////////////////////////////////
AnsiString s=ExtractFilePath(Application->ExeName)+"out.csv";
if(hcsv)closecsv();
  hcsv=FileCreate(s);
  return hcsv;
}
/////////////////////////////////////////////////////////////////////////////////
void addcsv(AnsiString s){ //добавить стоку s в csv-файл
/////////////////////////////////////////////////////////////////////////////////
  FileWrite(hcsv,s.c_str(),s.Length());
}
/////////////////////////////////////////////////////////////////////////////////
void closecsv(){// закрытие лог- файла
/////////////////////////////////////////////////////////////////////////////////
if(hcsv)FileClose(hcsv);
hcsv=0;
}
#pragma package(smart_init)
